{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "TODO",
  "title": "Softball App Data Schema",
  "description": "Defines the json object that holds all of the Softball App data for a given account",
  "type": "object",
  "required": ["metadata", "account", "players", "optimizations", "teams"],
  "properties": {
    "metadata": {
      "description": "Information about the json document itself",
      "type": "object",
      "required": ["version"],
      "properties": {
        "version": {
          "type": "integer",
          "description": "The version schema version of the json document"
        }
      }
    },
    "account": {
      "description": "Account preferences and status of the Softball.app account that created this document",
      "type": "object",
      "required": ["optimizers", "ballance"],
      "properties": {
        "optimizers": {
          "type": "array",
          "description": "A list of optimizer ids that the account has selected"
        },
        "ballance": {
          "type": "integer",
          "description": "READ ONLY: Number of optimizer credits the account has remaining"
        }
      }
    },
    "players": {
      "description": "List of all players associated with this document",
      "type": "array",
      "items": {
        "type": "object",
        "description": "Array of players",
        "required": ["id", "name", "gender", "song_link", "song_start"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Globally unique identifier for the player"
          },
          "name": { "type": "string", "description": "Name of the player" },
          "gender": { "type": "string", "description": "Gender of the player" },
          "song_link": {
            "type": "string",
            "description": "Walkup song YouTube link. TODO: camelCase"
          },
          "song_start": {
            "type": "string",
            "description": "Walkup song start time in seconds. TODO: camelCase"
          }
        }
      }
    },
    "teams": {
      "description": "List of all teams associated with this document",
      "type": "array",
      "items": {
        "type": "object",
        "description": "Array of teams",
        "required": ["id", "name", "games", "publicIdEnabled", "publicId"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Globally unique identifier for this team"
          },
          "name": {
            "type": "string",
            "description": "Human identifier for this team. Opponent name is used by the app. May not be unique."
          },
          "publicIdEnabled": {
            "type": "boolean",
            "description": "Whether or not the stats for the team should be available at a public web address"
          },
          "publicId": {
            "type": "sting",
            "description": "The unique identifier used to construct the public web address for this teams stats (if enabled)"
          },
          "games": {
            "type": "array",
            "description": "All games played by this team",
            "items": {
              "type": "object",
              "description": "Array of teams",
              "required": [
                "id",
                "opponent",
                "lineup",
                "date",
                "scoreUs",
                "scoreThem",
                "lineupType",
                "plateAppearances"
              ],
              "properties": {
                "id": {
                  "type": "string",
                  "description": "Globally unique identifier for the game"
                },
                "opponent": {
                  "type": "string",
                  "description": "Human identifier for the team. App prompts for the name of the opposing team. May not be unique."
                },
                "date": {
                  "type": "integer",
                  "description": "Epoch timestamp in seconds when the game was created, not necessarily played."
                },
                "scoreUs": {
                  "type": "integer",
                  "description": "Number of runs scored by this team in this game"
                },
                "scoreThem": {
                  "type": "integer",
                  "description": "Number of runs scored by this team's opponent in this game"
                },
                "lineupType": {
                  "type": "integer",
                  "description": "The type of the lineup used for this game. Typically this is a team-wide setting but specifying it under games allows for exceptions (e.g. tournaments w/ different rules). Different lineup types have different rules about what makes them valid (e.g. ALTERNATING_GENDER lineup must never bat two males or two females in a row)"
                },
                "plateAppearances": {
                  "type": "array",
                  "description": "All plate appearances that occurred during this game",
                  "items": {
                    "type": "object",
                    "description": "Array of plate appearances",
                    "required": ["id", "player_id", "result", "location"],
                    "properties": {
                      "id": {
                        "type": "string",
                        "description": "Globally unique identifier for the plate appearance"
                      },
                      "player_id": {
                        "type": "string",
                        "description": "The id of the player who is the batter during the plate appearance"
                      },
                      "result": {
                        "type": "string",
                        "description": "The outcome of the plate appearance for the batter (e.g. BB, E, 1B, etc.)"
                      },
                      "location": {
                        "type": "object",
                        "description": "The outcome of the plate appearance for the batter (e.g. BB, E, 1B, etc.)",
                        "required": ["x", "y"],
                        "x": {
                          "type": "integer",
                          "description": "X coordinate of where the ball was fielded (or where the ball ended at the end of the plate appearance if not fielded). Expressed as 32767ths of the field image from the left"
                        },
                        "y": {
                          "type": "integer",
                          "description": "Y coordinate of where the ball was fielded (or where the ball ended at the end of the plate appearance if not fielded). Expressed as 32767ths of the field image from the top"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "optimizations": {
      "description": "List of all optimizations associated with this document",
      "type": "array",
      "items": {
        "type": "object",
        "description": "Array of optimizations",
        "required": [
          "id",
          "name",
          "customOptionsData",
          "overrideData",
          "status",
          "resultData",
          "statusMessage",
          "sendEmail",
          "teamList",
          "gameList",
          "playerList",
          "lineupType",
          "optimizerType",
          "input_summary_data"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Globally unique identifier for the player"
          },
          "name": {
            "type": "string",
            "description": "Human identifier, could be a nickname or a number. This may not be unique."
          },
          "customOptionsData": {
            "type": "string",
            "description": "Serialized JSON representing parameters required by the selected optimizerType"
          },
          "overrideData": {
            "type": "string",
            "description": "Serialized JSON game data that will be used by the optimization instead of a players historical data. This is useful for when there is a new player without any historical data. "
          },
          "status": {
            "type": "string",
            "description": "Indicates what state the optimization is currently in e.g. NOT_STARTED, IN_PROGRESS, COMPLETE etc."
          },
          "resultData": {
            "type": "string",
            "description": "Serialized JSON containing the results of a simulation. Results can be partial (if the simulation is not in a terminal state) or final. "
          },
          "statusMessage": {
            "type": "string",
            "description": "Additional information about the current status. Intended for human consumption only."
          },
          "sendEmail": {
            "type": "boolean",
            "description": "Whether or not the user would like to receive an email with the results ofter the optimization completes."
          },
          "teamList": {
            "type": "string",
            "description": "Serialized JSON containing an array of team ids for which data will be used by the optimizer"
          },
          "gameList": {
            "type": "string",
            "description": "Serialized JSON containing an array of game ids for which data will be used by the optimizer"
          },
          "playerList": {
            "type": "string",
            "description": "Serialized JSON containing an array of player ids that should be turned into an optimal lineup by the optimizer"
          },
          "lineupType": {
            "type": "integer",
            "description": "The type of the lineup the optimizer should return. Different lineup types have different rules about what makes them valid (e.g. ALTERNATING_GENDER lineup must never bat two males or two females in a row)"
          },
          "optimizerType": {
            "type": "integer",
            "description": "The type of optimizer that should be used for this optimization. A list of optimizers and their descriptions can be found at https://optimizers.softball.app/"
          },
          "input_summary_data": {
            "type": "string",
            "description": "Serialized JSON that contains a snapshot summary of the data that was sent to the optimizer when the optimization was started. Once the snapshot is taken, it does not change as the app's data changes."
          }
        }
      }
    }
  }
}
